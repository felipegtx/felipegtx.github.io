<html>

<head>
    <title>Raska</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/css/bootstrap.css">
    <!-- Optional theme -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/css/bootstrap-theme.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">

</head>

<body>
    <div class="container">
        <nav class="navbar navbar-default navbar-static-top">
            <div class="container-fluid">

                <a class="navbar-brand" href="https://github.com/felipegtx/Raska" target="_blank">Raska!</a>
                <p class="navbar-text  navbar-right">
                    You can find the docs
                    <a href="http://felipegtx.github.io/Raska/docs/index.html" target="_blank">
                        <strong>in here</strong>
                    </a>&nbsp;&nbsp;&nbsp;
                </p>
            </div>
        </nav>
        <ul class="nav nav-tabs" role="tablist">
            <li role="presentation" class="active"><a href="#info" role="tab" data-toggle="tab">Info</a></li>
            <li role="presentation"><a href="#addElements" aria-controls="profile" role="tab" data-toggle="tab">Add elements</a></li>
            <li role="presentation"><a href="#importExport" aria-controls="messages" role="tab" data-toggle="tab">Import / Export</a></li>
        </ul>
        <br />
        <div class="tab-content">
            <div role="tabpanel" class="tab-pane active" id="info">
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="headingOne">
                        <a role="button" data-toggle="collapse" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                            Lib details <em class="pull-right"><small>click here to collapse / expand the content</small></em>
                        </a>
                    </div>
                    <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
                        <div class="panel-body">
                            <ul class="list-group">
                                <li class="list-group-item">
                                    Click on a node and press
                                    <kbd>DEL</kbd> (<em>while still holding the <kbd>mouse click</kbd> down</em>) to delete it
                                </li>
                                <li class="list-group-item">
                                    Drag a node (using either your mouse
                                    <kbd>right click</kbd> or holding down the <kbd>control</kbd> key) and move it over another to create a link
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div role="tabpanel" class="tab-pane" id="addElements">
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="headingTwo">
                        <a role="button" data-toggle="collapse" href="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
                            Add elements <em class="pull-right"><small>click here to collapse / expand the content</small></em>
                        </a>
                    </div>
                    <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
                        <div class="panel-body">
                            <label for="elementLabel">Label:</label>
                            <input class="form-control" type="text" id="elementLabel" name="elementLabel" />
                        </div>
                        <div class="panel-footer">
                            <button class="btn btn-default" onclick="addSquare();">Add square</button>
                            <button class="btn btn-default" onclick="addCircle();">Add circle</button>
                            <button class="btn btn-default" onclick="addTriangle();">Add triangle (UP)</button>
                            <button class="btn btn-default" onclick="addTriangle(true);">Add triangle (DOWN)</button>
                        </div>
                    </div>
                </div>
            </div>
            <div role="tabpanel" class="tab-pane" id="importExport">
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="headingThree">
                        <a role="button" data-toggle="collapse" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
                            Import / Export data <em class="pull-right"><small>click here to collapse / expand the content</small></em>
                        </a>
                    </div>
                    <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
                        <div class="panel-body">
                            <label for="elementGraph">Element graph:</label>
                            <textarea class="form-control" id="elementGraph" rows="8">[{"linksTo":["square__cf06c0c08b74d8df502f89dc7a971ccf","square__db94e8aecb2c94eb76df36cae7808812"],"childElements":["label__6db884d155fd45405928523d1cbd1dd6"],"parent":null,"type":"circle","name":"circle__28123e80e6068bc52bee1ab8d726ddad","border":{"color":"gray","active":true,"width":2},"fillColor":"silver","radius":20,"attr":{},"graphNode":true,"position":0,"x":85.22943037974683,"y":102.58964143426294},{"linksTo":[],"childElements":[],"parent":"circle__28123e80e6068bc52bee1ab8d726ddad","type":"label","name":"label__6db884d155fd45405928523d1cbd1dd6","graphNode":false,"text":"Start","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"12px","decoration":""},"attr":{},"position":0},{"linksTo":["triangle__ccdaa71a21877ffba913fb5f2b5521ae"],"childElements":["label__786f231a524ebb2c8b8c71a65fb89054"],"parent":null,"type":"square","name":"square__cf06c0c08b74d8df502f89dc7a971ccf","border":{"color":"gray","active":true,"width":2},"fillColor":"silver","dimensions":{"width":50,"height":50},"globalAlpha":1,"attr":{},"graphNode":true,"position":0,"x":218.80537974683543,"y":50.79681274900398},{"linksTo":[],"childElements":[],"parent":"square__cf06c0c08b74d8df502f89dc7a971ccf","type":"label","name":"label__786f231a524ebb2c8b8c71a65fb89054","graphNode":false,"text":"Do something","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"12px","decoration":""},"attr":{},"position":0},{"linksTo":["square__b54a3adb5dfacd9d6150e8f1185365c0"],"childElements":["label__5cf6595ca71b482f0c2b10568c4d5b94"],"parent":null,"type":"square","name":"square__db94e8aecb2c94eb76df36cae7808812","border":{"color":"gray","active":true,"width":2},"fillColor":"silver","dimensions":{"width":50,"height":50},"globalAlpha":1,"attr":{},"graphNode":true,"position":0,"x":193.88449367088606,"y":154.3824701195219},{"linksTo":[],"childElements":[],"parent":"square__db94e8aecb2c94eb76df36cae7808812","type":"label","name":"label__5cf6595ca71b482f0c2b10568c4d5b94","graphNode":false,"text":"Do something else","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"12px","decoration":""},"attr":{},"position":0},{"linksTo":["triangle__955dda5d6b0dc9a9fa1150c8aabcdb01","triangle__ccdaa71a21877ffba913fb5f2b5521ae"],"childElements":["label__1172e2d9d40a16b433aecf03d3816061"],"parent":null,"type":"square","name":"square__b54a3adb5dfacd9d6150e8f1185365c0","border":{"color":"gray","active":true,"width":2},"fillColor":"silver","dimensions":{"width":50,"height":50},"globalAlpha":1,"attr":{},"graphNode":true,"position":0,"x":196.376582278481,"y":279.8804780876494},{"linksTo":[],"childElements":[],"parent":"square__b54a3adb5dfacd9d6150e8f1185365c0","type":"label","name":"label__1172e2d9d40a16b433aecf03d3816061","graphNode":false,"text":"Then another","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"12px","decoration":""},"attr":{},"position":0},{"linksTo":["circle__ff5e8210892115f6d96e874eb35571bf","square__a68c16987322cad3f85670c036d21941"],"childElements":["label__296ae2c82d54b07cc9c0610d79176c95"],"parent":null,"type":"triangle","name":"triangle__ccdaa71a21877ffba913fb5f2b5521ae","border":{"color":"gray","active":true,"width":2},"fillColor":"silver","pointingUp":true,"dimensions":{"width":50,"height":50},"attr":{"click":{"x":495.92563291139237,"y":83.66533864541833}},"graphNode":true,"position":0,"x":472.001582278481,"y":95.61752988047809},{"linksTo":[],"childElements":[],"parent":"triangle__ccdaa71a21877ffba913fb5f2b5521ae","type":"label","name":"label__296ae2c82d54b07cc9c0610d79176c95","graphNode":false,"text":"Then another","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"12px","decoration":""},"attr":{},"position":0},{"linksTo":["circle__ff5e8210892115f6d96e874eb35571bf","square__a68c16987322cad3f85670c036d21941"],"childElements":["label__550c011c396ec1922888cfb1af34b97b"],"parent":null,"type":"triangle","name":"triangle__955dda5d6b0dc9a9fa1150c8aabcdb01","border":{"color":"gray","active":true,"width":2},"fillColor":"silver","pointingUp":true,"dimensions":{"width":50,"height":50},"attr":{"click":{"x":508.88449367088606,"y":322.70916334661354}},"graphNode":true,"position":0,"x":479.9762658227848,"y":346.61354581673305},{"linksTo":[],"childElements":[],"parent":"triangle__955dda5d6b0dc9a9fa1150c8aabcdb01","type":"label","name":"label__550c011c396ec1922888cfb1af34b97b","graphNode":false,"text":"Maybe another","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"12px","decoration":""},"attr":{},"position":0},{"linksTo":[],"childElements":["label__f22ea400baa01ddebcbc88ffcb7e09d4"],"parent":null,"type":"circle","name":"circle__ff5e8210892115f6d96e874eb35571bf","border":{"color":"gray","active":true,"width":2},"fillColor":"silver","radius":20,"attr":{},"graphNode":true,"position":0,"x":580.6566455696202,"y":195.21912350597609},{"linksTo":[],"childElements":[],"parent":"circle__ff5e8210892115f6d96e874eb35571bf","type":"label","name":"label__f22ea400baa01ddebcbc88ffcb7e09d4","graphNode":false,"text":"Done!","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"12px","decoration":""},"attr":{},"position":0},{"linksTo":["circle__ff5e8210892115f6d96e874eb35571bf"],"childElements":["label__6fc21236b5f3a56cce7628364401897e"],"parent":null,"type":"square","name":"square__a68c16987322cad3f85670c036d21941","border":{"color":"gray","active":true,"width":2},"fillColor":"silver","dimensions":{"width":50,"height":50},"globalAlpha":1,"attr":{},"graphNode":true,"position":0,"x":410.19778481012656,"y":190.23904382470118},{"linksTo":[],"childElements":[],"parent":"square__a68c16987322cad3f85670c036d21941","type":"label","name":"label__6fc21236b5f3a56cce7628364401897e","graphNode":false,"text":"Something","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"12px","decoration":""},"attr":{},"position":0},{"linksTo":["square__a68c16987322cad3f85670c036d21941","triangle__955dda5d6b0dc9a9fa1150c8aabcdb01"],"childElements":["label__afc842b411b4e5b2635a8bdda24b64b4"],"parent":null,"type":"triangle","name":"triangle__7841b71443ad94b42ff6089daea8fe8e","border":{"color":"gray","active":true,"width":2},"fillColor":"silver","pointingUp":false,"dimensions":{"width":50,"height":50},"attr":{"click":{"x":345.40348101265823,"y":229.08366533864543}},"graphNode":true,"position":0,"x":313.00632911392404,"y":251.99203187250995},{"linksTo":[],"childElements":[],"parent":"triangle__7841b71443ad94b42ff6089daea8fe8e","type":"label","name":"label__afc842b411b4e5b2635a8bdda24b64b4","graphNode":false,"text":"Hummm","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"12px","decoration":""},"attr":{},"position":0}]</textarea>
                        </div>
                        <div class="panel-footer">
                            <button class="btn btn-primary" onclick="getGraph();">Get dependency graph</button>
                            <button class="btn btn-info" onclick="loadGraph();">Load dependency graph</button>
                            <button class="btn btn-success" onclick="saveImage();">Save image</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-2"></div>
            <div class="col-md-8">
                <canvas id="raskaContent" style="border: 1px solid silver;" width="630" height="500"></canvas>
            </div>
            <div class="col-md-2"></div>
        </div>
        <br /><br />
    </div>
    <script type="text/javascript" src="../src/raska.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script>
        /// Configures raska to a given Canvas element
        raska.installUsing({ targetCanvasId: "raskaContent" });

        /// Random positioning
        var canvasRect = document.getElementById("raskaContent").getBoundingClientRect(),
            padding = 50;

        function getRandomPosition() {
            return {
                x: Math.abs(Math.random() * (canvasRect.width - padding)),
                y: Math.abs(Math.random() * (canvasRect.height - padding))
            };
        }

        function notifyDeletion(element) {
            console.log("Element was removed", element);
        }

        /// Adds some elements so we can play with...
        var position;
        function addSquare() {
            position = getRandomPosition();
            var square = raska.newSquare();
            var label = raska.newLabel();
            square.y = position.y;
            square.x = position.x;
            label.text = document.getElementById("elementLabel").value;
            square.addChild(label).notifyDisableStateOn(notifyDeletion);
            raska.plot(square);
        }

        function addCircle() {
            position = getRandomPosition();
            var circle = raska.newCircle();
            var label = raska.newLabel();
            circle.x = position.x;
            circle.y = position.y;
            label.text = document.getElementById("elementLabel").value;
            circle.addChild(label).notifyDisableStateOn(notifyDeletion);
            raska.plot(circle);
        }

        function addTriangle(poitingDown) {
            position = getRandomPosition();
            var triangle = raska.newTriangle(!poitingDown);
            var label = raska.newLabel();
            triangle.y = position.y;
            triangle.x = position.x;
            triangle.on.click(function (x, y, e, ev) {
                e.attr["click"] = { x: x, y: y };
            });
            label.text = document.getElementById("elementLabel").value;
            triangle.addChild(label).notifyDisableStateOn(notifyDeletion);
            raska.plot(triangle);
        }

        function saveImage() {
            raska.exportImage();
        }

        function getGraph() {
            try {
                document.getElementById("elementGraph").value = raska.getElementsString();
                alert("Exported to textarea");
            } catch (e) {
                alert("It was not possible to generate the graph. - " + e.message);
            }
        }

        function loadGraph() {
            try {
                var elementGraph = document.getElementById("elementGraph").value;
                if (elementGraph !== "") {

                    // load json onto canvas
                    raska.loadElementsFrom(elementGraph);

                }
            } catch (e) {
                alert("It was not possible to import the graph. - " + e.message);
            }
        }

        loadGraph();

    </script>
</body>
</html>