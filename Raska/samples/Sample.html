<html>

<head>
    <title>Raska</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/css/bootstrap.css">
    <!-- Optional theme -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/css/bootstrap-theme.min.css">
</head>

<body>
    <div class="container">
        <nav class="navbar navbar-default navbar-static-top">
            <div class="container-fluid">

                <a class="navbar-brand" href="https://github.com/felipegtx/Raska" target="_blank">Raska!</a>
                <p class="navbar-text  navbar-right">
                    You can find the docs
                    <a href="http://felipegtx.github.io/Raska/docs/index.html" target="_blank">
                        <strong>in here</strong>
                    </a>&nbsp;&nbsp;&nbsp;
                </p>
            </div>
        </nav>
        <ul class="nav nav-tabs" role="tablist">
            <li role="presentation" class="active"><a href="#info" role="tab" data-toggle="tab">Info</a></li>
            <li role="presentation"><a href="#addElements" aria-controls="profile" role="tab" data-toggle="tab">Add elements</a></li>
            <li role="presentation"><a href="#importExport" aria-controls="messages" role="tab" data-toggle="tab">Import / Export</a></li>
        </ul>
        <br />
        <div class="tab-content">
            <div role="tabpanel" class="tab-pane active" id="info">
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="headingOne">
                        <a role="button" data-toggle="collapse" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                            Lib details <em class="pull-right"><small>click here to collapse / expand the content</small></em>
                        </a>
                    </div>
                    <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
                        <div class="panel-body">
                            <ul class="list-group">
                                <li class="list-group-item">
                                    Click on a node and press
                                    <kbd>DEL</kbd> (<em>while still holding the <kbd>mouse click</kbd> down</em>) to delete it
                                </li>
                                <li class="list-group-item">
                                    Drag a node (using either your mouse
                                    <kbd>right click</kbd> or holding down the <kbd>control</kbd> key) and move it over another to create a link
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div role="tabpanel" class="tab-pane" id="addElements">
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="headingTwo">
                        <a role="button" data-toggle="collapse" href="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
                            Add elements <em class="pull-right"><small>click here to collapse / expand the content</small></em>
                        </a>
                    </div>
                    <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
                        <div class="panel-body">
                            <label for="elementLabel">Label:</label>
                            <input class="form-control" type="text" id="elementLabel" name="elementLabel" />
                        </div>
                        <div class="panel-footer">
                            <button class="btn btn-default" onclick="addSquare();">Add square</button>
                            <button class="btn btn-default" onclick="addCircle();">Add circle</button>
                            <button class="btn btn-default" onclick="addTriangle();">Add triangle</button>
                        </div>
                    </div>
                </div>
            </div>
            <div role="tabpanel" class="tab-pane" id="importExport">
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="headingThree">
                        <a role="button" data-toggle="collapse" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
                            Import / Export data <em class="pull-right"><small>click here to collapse / expand the content</small></em>
                        </a>
                    </div>
                    <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
                        <div class="panel-body">
                            <label for="elementGraph">Element graph:</label>
                            <textarea class="form-control" id="elementGraph" rows="8">[{"linksTo":["square__1b903f39c8133b8ea20fccd427ad92b0"],"childElements":["label__f64a2e34561a27e206ccbea1f10c0f99"],"parent":null,"type":"circle","name":"circle__ad6266bcbc7bbb1d8850a5da052c6e89","border":{"color":"gray","active":true,"width":2},"fillColor":"silver","radius":20,"graphNode":true,"position":0,"x":54.862842892768086,"y":56.83760683760684},{"linksTo":[],"childElements":[],"parent":"circle__ad6266bcbc7bbb1d8850a5da052c6e89","type":"label","name":"label__f64a2e34561a27e206ccbea1f10c0f99","graphNode":false,"text":"Start something","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"15px"},"position":0},{"linksTo":[],"childElements":[],"parent":"circle__ad6266bcbc7bbb1d8850a5da052c6e89","type":"label","name":"label__f64a2e34561a27e206ccbea1f10c0f99","graphNode":false,"text":"Start something","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"15px"},"position":0},{"linksTo":["triangle__4170fe7ac66c106a4023258e08a9f8f3","triangle__f35e5febbbeeeea769758fee09478e1b"],"childElements":["label__328a9ba799a967703c66f449fdfb070e"],"parent":null,"type":"square","name":"square__1b903f39c8133b8ea20fccd427ad92b0","border":{"color":"gray","active":true,"width":2},"fillColor":"silver","dimensions":{"width":50,"height":50},"globalAlpha":1,"graphNode":true,"position":0,"x":83.79052369077307,"y":227.35042735042737},{"linksTo":[],"childElements":[],"parent":"square__1b903f39c8133b8ea20fccd427ad92b0","type":"label","name":"label__328a9ba799a967703c66f449fdfb070e","graphNode":false,"text":"Do something","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"15px"},"position":0},{"linksTo":[],"childElements":[],"parent":"square__1b903f39c8133b8ea20fccd427ad92b0","type":"label","name":"label__328a9ba799a967703c66f449fdfb070e","graphNode":false,"text":"Do something","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"15px"},"position":0},{"linksTo":["square__927d4c159753cc98a2f121d781365283"],"childElements":["label__6ccb85b79c90caa975b0e961ee0e5e38"],"parent":null,"type":"triangle","name":"triangle__4170fe7ac66c106a4023258e08a9f8f3","border":{"color":"gray","active":true,"width":2},"fillColor":"silver","pointingUp":true,"dimensions":{"width":50,"height":50},"graphNode":true,"position":0,"x":310.22443890274315,"y":347.008547008547},{"linksTo":[],"childElements":[],"parent":"triangle__4170fe7ac66c106a4023258e08a9f8f3","type":"label","name":"label__6ccb85b79c90caa975b0e961ee0e5e38","graphNode":false,"text":"If something","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"15px"},"position":0},{"linksTo":[],"childElements":[],"parent":"triangle__4170fe7ac66c106a4023258e08a9f8f3","type":"label","name":"label__6ccb85b79c90caa975b0e961ee0e5e38","graphNode":false,"text":"If something","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"15px"},"position":0},{"linksTo":["circle__e23d1fd67032ea3eb9813bdfe6db2492","square__761af6f0db9d8f6577d1c94160e43156"],"childElements":["label__7427b9da97a019e1ce655484a1807c40"],"parent":null,"type":"triangle","name":"triangle__f35e5febbbeeeea769758fee09478e1b","border":{"color":"gray","active":true,"width":2},"fillColor":"silver","pointingUp":true,"dimensions":{"width":50,"height":50},"graphNode":true,"position":0,"x":367.08229426433917,"y":237.32193732193733},{"linksTo":[],"childElements":[],"parent":"triangle__f35e5febbbeeeea769758fee09478e1b","type":"label","name":"label__7427b9da97a019e1ce655484a1807c40","graphNode":false,"text":"If something else","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"15px"},"position":0},{"linksTo":[],"childElements":[],"parent":"triangle__f35e5febbbeeeea769758fee09478e1b","type":"label","name":"label__7427b9da97a019e1ce655484a1807c40","graphNode":false,"text":"If something else","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"15px"},"position":0},{"linksTo":[],"childElements":["label__e23f7b212c6cc0485b28501686881478"],"parent":null,"type":"circle","name":"circle__e23d1fd67032ea3eb9813bdfe6db2492","border":{"color":"gray","active":true,"width":2},"fillColor":"silver","radius":20,"graphNode":true,"position":0,"x":344.139650872818,"y":27.920227920227923},{"linksTo":[],"childElements":[],"parent":"circle__e23d1fd67032ea3eb9813bdfe6db2492","type":"label","name":"label__e23f7b212c6cc0485b28501686881478","graphNode":false,"text":"End","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"15px"},"position":0},{"linksTo":[],"childElements":[],"parent":"circle__e23d1fd67032ea3eb9813bdfe6db2492","type":"label","name":"label__e23f7b212c6cc0485b28501686881478","graphNode":false,"text":"End","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"15px"},"position":0},{"linksTo":["circle__e23d1fd67032ea3eb9813bdfe6db2492"],"childElements":["label__69d614a7a6e0f9eea62cb3aadcc35f37"],"parent":null,"type":"square","name":"square__927d4c159753cc98a2f121d781365283","border":{"color":"gray","active":true,"width":2},"fillColor":"silver","dimensions":{"width":50,"height":50},"globalAlpha":1,"graphNode":true,"position":0,"x":196.50872817955113,"y":177.4928774928775},{"linksTo":[],"childElements":[],"parent":"square__927d4c159753cc98a2f121d781365283","type":"label","name":"label__69d614a7a6e0f9eea62cb3aadcc35f37","graphNode":false,"text":"Do something else","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"15px"},"position":0},{"linksTo":[],"childElements":[],"parent":"square__927d4c159753cc98a2f121d781365283","type":"label","name":"label__69d614a7a6e0f9eea62cb3aadcc35f37","graphNode":false,"text":"Do something else","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"15px"},"position":0},{"linksTo":["circle__e23d1fd67032ea3eb9813bdfe6db2492"],"childElements":["label__d19cc69aabd690979a2854f7368b891a"],"parent":null,"type":"square","name":"square__761af6f0db9d8f6577d1c94160e43156","border":{"color":"gray","active":true,"width":2},"fillColor":"silver","dimensions":{"width":50,"height":50},"globalAlpha":1,"graphNode":true,"position":0,"x":549.6259351620948,"y":100.71225071225072},{"linksTo":[],"childElements":[],"parent":"square__761af6f0db9d8f6577d1c94160e43156","type":"label","name":"label__d19cc69aabd690979a2854f7368b891a","graphNode":false,"text":"Do nothing","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"15px"},"position":0},{"linksTo":[],"childElements":[],"parent":"square__761af6f0db9d8f6577d1c94160e43156","type":"label","name":"label__d19cc69aabd690979a2854f7368b891a","graphNode":false,"text":"Do nothing","color":"gray","x":0,"y":0,"border":{"color":"white","active":true,"width":2},"font":{"family":"Arial","size":"15px"},"position":0}]</textarea>
                        </div>
                        <div class="panel-footer">
                            <button class="btn btn-primary" onclick="getGraph();">Get dependency graph</button>
                            <button class="btn btn-info" onclick="loadGraph();">Load dependency graph</button>
                            <button class="btn btn-success" onclick="saveImage();">Save image</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-2"></div>
            <div class="col-md-8">
                <canvas id="raskaContent" style="border: 1px solid silver;" width="700" height="500"></canvas>
            </div>
            <div class="col-md-2"></div>
        </div>
        <br /><br />
    </div>
    <script type="text/javascript" src="../src/raska.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script>
        /// Configures raska to a given Canvas element
        raska.installUsing({ targetCanvasId: "raskaContent" });

        /// Random positioning
        var canvasRect = document.getElementById("raskaContent").getBoundingClientRect(),
            padding = 50;

        function getRandomPosition() {
            return {
                x: Math.abs(Math.random() * (canvasRect.width - padding)),
                y: Math.abs(Math.random() * (canvasRect.height - padding))
            };
        }

        function notifyDeletion(element) {
            console.log("Element was removed", element);
        }

        /// Adds some elements so we can play with...
        var position;
        function addSquare() {
            position = getRandomPosition();
            var square = raska.newSquare();
            var label = raska.newLabel();
            square.y = position.y;
            square.x = position.x;
            label.text = document.getElementById("elementLabel").value;
            square.addChild(label).notifyDisableStateOn(notifyDeletion);
            raska.plot(square);
        }

        function addCircle() {
            position = getRandomPosition();
            var circle = raska.newCircle();
            var label = raska.newLabel();
            circle.x = position.x;
            circle.y = position.y;
            label.text = document.getElementById("elementLabel").value;
            circle.addChild(label).notifyDisableStateOn(notifyDeletion);
            raska.plot(circle);
        }

        function addTriangle() {
            position = getRandomPosition();
            var triangle = raska.newTriangle();
            var label = raska.newLabel();
            triangle.y = position.y;
            triangle.x = position.x;
            triangle.on.click(function (x, y, e, ev) {
                e.attr["click"] = { x: x, y: y };
            });
            label.text = document.getElementById("elementLabel").value;
            triangle.addChild(label).notifyDisableStateOn(notifyDeletion);
            raska.plot(triangle);
        }

        function saveImage() {
            raska.exportImage();
        }

        function getGraph() {
            try {
                document.getElementById("elementGraph").value = raska.getElementsString();
                alert("Exported to textarea");
            } catch (e) {
                alert("It was not possible to generate the graph. - " + e.message);
            }
        }

        function loadGraph() {
            try {
                var elementGraph = document.getElementById("elementGraph").value;
                if (elementGraph !== "") {

                    // load json onto canvas
                    raska.loadElementsFrom(elementGraph);

                }
            } catch (e) {
                alert("It was not possible to import the graph. - " + e.message);
            }
        }

        loadGraph();
        addTriangle();

    </script>
</body>
</html>